import{a$ as I,ar as N,an as O,b0 as _,ae as m}from"./index.7d8ab6d7.js";import{g as w}from"./position.1efafded.js";import{g as L}from"./scroll.fb82158d.js";var A="Expected a function";function p(t,i,e){var n=!0,o=!0;if(typeof t!="function")throw new TypeError(A);return I(e)&&(n="leading"in e?!!e.leading:n,o="trailing"in e?!!e.trailing:o),N(t,i,{leading:n,maxWait:i,trailing:o})}const r="ElInfiniteScroll",C=50,D=200,F=0,x={delay:{type:Number,default:D},distance:{type:Number,default:F},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},E=(t,i)=>Object.entries(x).reduce((e,[n,o])=>{var u,l;const{type:d,default:s}=o,a=t.getAttribute(`infinite-scroll-${n}`);let c=(l=(u=i[a])!=null?u:a)!=null?l:s;return c=c==="false"?!1:c,c=d(c),e[n]=Number.isNaN(c)?s:c,e},{}),T=t=>{const{observer:i}=t[r];i&&(i.disconnect(),delete t[r].observer)},R=(t,i)=>{const{container:e,containerEl:n,instance:o,observer:u,lastScrollTop:l}=t[r],{disabled:d,distance:s}=E(t,o),{clientHeight:a,scrollHeight:c,scrollTop:f}=n,h=f-l;if(t[r].lastScrollTop=f,u||d||h<0)return;let b=!1;if(e===t)b=c-(a+f)<=s;else{const{clientTop:S,scrollHeight:y}=t,H=w(t,n);b=f+a>=H+S+y-s}b&&i.call(o)};function g(t,i){const{containerEl:e,instance:n}=t[r],{disabled:o}=E(t,n);o||e.clientHeight===0||(e.scrollHeight<=e.clientHeight?i.call(n):T(t))}const U={async mounted(t,i){const{instance:e,value:n}=i;O(n)||_(r,"'v-infinite-scroll' binding value must be a function"),await m();const{delay:o,immediate:u}=E(t,e),l=L(t,!0),d=l===window?document.documentElement:l,s=p(R.bind(null,t,n),o);if(!!l){if(t[r]={instance:e,container:l,containerEl:d,delay:o,cb:n,onScroll:s,lastScrollTop:d.scrollTop},u){const a=new MutationObserver(p(g.bind(null,t,n),C));t[r].observer=a,a.observe(t,{childList:!0,subtree:!0}),g(t,n)}l.addEventListener("scroll",s)}},unmounted(t){const{container:i,onScroll:e}=t[r];i==null||i.removeEventListener("scroll",e),T(t)},async updated(t){t[r]||await m();const{containerEl:i,cb:e,observer:n}=t[r];i.clientHeight&&n&&g(t,e)}},v=U;v.install=t=>{t.directive("InfiniteScroll",v)};const B=v;export{B as E};
